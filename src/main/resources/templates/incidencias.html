<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="layout/layout :: head"></head>
<body>

	<header th:replace="layout/layout :: header"></header>

	<div class="container-fluid py-5 col-md-10 col-sm-12">
		<div class="card bg-light">
			<div class="card-header font-weight-bold" th:text="${titulo}"></div>
			<div class="card-body">

				<div class="row">
					<div class="col-lg-3 col-md-6 col-sm-6">
						<div class="card card-stats">
							<div class="card-header card-header-success card-header-icon">
								<div class="card-icon1 bg-danger text-white">
									<i class="fas fa-times"></i>
								</div>
								<p class="card-category text-right">Errores</p>
								<h3 class="card-title text-right" th:text="${totalErrores}"></h3>
								<div class="card-footer text-center">
									<a href="#">Ver Errores</a>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6">
						<div class="card card-stats">
							<div class="card-header card-header-warning card-header-icon">
								<div class="card-icon2 bg-warning text-white">
									<i class="fas fa-exclamation-triangle"></i>
								</div>
								<p class="card-category text-right">Advertencias</p>
								<h3 class="card-title text-right" th:text="${totalAdvertencias}"></h3>
								<div class="card-footer text-center">
									<a href="#">Ver Advertencias</a>
								</div>
							</div>
						</div>
					</div>

					<div class="col-lg-3 col-md-6 col-sm-6">
						<div class="card card-stats">
							<div class="card-header card-header-danger card-header-icon">
								<div class="card-icon3 bg-info text-white">
									<i class="far fa-eye"></i>
								</div>
								<p class="card-category text-right">Abiertas</p>
								<h3 class="card-title text-right" th:text="${totalAbiertas}"></h3>
								<div class="card-footer text-center">
									<a href="#">Ver Abiertas</a>
								</div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-6 col-sm-6">
						<div class="card card-stats">
							<div class="card-header card-header-info card-header-icon">
								<div class="card-icon4 bg-success text-white">
									<i class="far fa-check-circle"></i>
								</div>
								<p class="card-category text-right">Resueltas</p>
								<h3 class="card-title text-right" th:text="${totalSolucionadas}"></h3>
								<div class="card-footer text-center">
									<a href="#">Ver Resueltas</a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="row pt-3">
					<div class="col-lg-8 col-md-12 col-sm-12 text-center ">

						<div class="card shadow mb-4 h-100">
							<div
								class="card-header py-3 text-center">
								<h6 class="m-0 font-weight-bold">Datos de las incidencias</h6>

							</div>
							<table id="table" class="table table-responsive table-hover">
								<thead class="text-center bg-dark text-white">
									<tr>
										<th>Usuario</th>
										<th>Fecha</th>
										<th>Estado</th>
										<th>Tipo</th>
										<th>Mensaje</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="incidencia : ${incidencias}">
										<td data-toggle="tooltip" data-placement="left" data-type="primary" 
										th:title="${incidencia.empleado.nombre} +' '+${incidencia.empleado.apellido1}+' '+${incidencia.empleado.apellido2}"
										 th:text="${incidencia.empleado.usuario.username}"></td>

										<td th:text="${incidencia.fecha}"></td>
										<td
											th:text="${incidencia.estado == '1' ? '&nbspAbierta&nbsp ' : '&nbspResuelta&nbsp'}"></td>
										<td
											th:text="${incidencia.tipo == '1'} ? 'Error' : 'Advertencia'"
											th:class="${incidencia.tipo == '1'} ? 'text-danger font-weight-bold' : 'text-warning font-weight-bold'">
										</td>
										<td th:text="${incidencia.mensaje}"></td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="col-lg-4 col-md-12 col-sm-12">


						<div class="card shadow mb-4 h-100">
							<!-- Card Header - Dropdown -->
							<div
								class="card-header py-3 text-center">
								<h6 class="m-0 font-weight-bold">Estad√≠sticas</h6>

							</div>
							<!-- Card Body -->
							<div class="card-body">
								<div class="chart-pie pt-2 pb-2">
									<div class="chartjs-size-monitor">
										<div class="chartjs-size-monitor-expand">
											<div class=""></div>
										</div>
										<div class="chartjs-size-monitor-shrink">
											<div class=""></div>
										</div>
									</div>
									<canvas id="myChart"
										style="position:relative; display: flex; width: 25rem; height: 20rem;"
									 	class="chartjs-render-monitor"></canvas>
								</div>

							</div>
						</div>


					</div>
				</div>



			</div>
		</div>
	</div>
	<footer th:replace="layout/layout :: footer"></footer>

	<script>
var ctx = document.getElementById('myChart').getContext('2d');
var totalErrores = [[${totalErrores}]];
var totalAdvertencias = [[${totalAdvertencias}]];
var totalAbiertas = [[${totalAbiertas}]];
var totalSolucionadas = [[${totalSolucionadas}]];
var option = {
		  responsive: true
		};
var myChart = new Chart(ctx, {
    type: 'doughnut',
    options: option,
    data: {
        labels: ['Errores', 'Advertencias', 'Abiertas', 'Resueltas'],
        datasets: [{
            label: '# of Votes',
            data: [totalErrores, totalAdvertencias, totalAbiertas, totalSolucionadas],
            backgroundColor: [
                'rgba(217,83,79)',
                'rgba(255,193,0)',
                'rgba(66,139,202)',
                'rgba(92,184,92)'
            ]
        }]
    }
    
});
</script>

</body>

</html>